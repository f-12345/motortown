<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Motor Town Inc | Inventory</title>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>

<header class="topbar">
  <div class="container nav-wrap">
    <a class="brand" href="index.html">
      <img src="assets/images/logo.png" alt="Motor Town Inc" class="brand-logo">
      <div>
        Motor Town Inc
        <small>Inventory • Financing • Service</small>
      </div>
    </a>

    <button class="hamburger" aria-label="Open menu" aria-expanded="false" type="button">Menu</button>

    <nav class="nav" aria-label="Primary">
      <a class="nav-link" href="inventory.html">Inventory</a>

      <div class="nav-item has-dd">
        <a class="nav-link" href="#" data-dd="true">Financing <span class="chev">▼</span></a>
        <div class="dropdown">
          <a href="financing.html">Finance</a>
          <a href="get-prequalified.html">Get Pre-Qualified</a>
          <a href="financing-faq.html">Financing FAQ</a>
        </div>
      </div>

      <nav class="nav">
        <a class="nav-link" href="https://motortowncars.startyourcreditapproval.com/">Lenders</a>
      </nav>

      <a class="nav-link" href="trade-sell.html">Trade/Sell Your Car</a>

      <div class="nav-item has-dd">
        <a class="nav-link" href="#" data-dd="true">Services <span class="chev">▼</span></a>
        <div class="dropdown">
          <a href="services.html">Service Overview</a>
          <a href="schedule-service.html">Schedule Service</a>
          <a href="general-services.html">General Services</a>
        </div>
      </div>

      <a class="nav-link" href="contact.html">Contact Us</a>
    </nav>
  </div>
</header>

<main>
  <section class="hero">
    <div class="container">
      <div class="tile">
        <img class="tile-img" style="height:320px"
             src="https://images.unsplash.com/photo-1503376780353-7e6692767b70?auto=format&fit=crop&w=2200&q=60"
             alt="Inventory">
        <div class="tile-body">
          <div class="kicker">Inventory</div>
          <h2 style="margin:8px 0 6px;">Browse available vehicles</h2>
          <p>View our current selection of quality pre-owned vehicles available on our lot.</p>
          <div class="btn-row">
            <a class="btn primary" href="get-prequalified.html">Get Pre-Qualified</a>
            <a class="btn" href="trade-sell.html">Trade/Sell Your Car</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="card" style="margin-bottom:14px;">
        <div class="kicker">Quick Filters</div>
        <div class="split" style="margin-top:10px;">
          <div class="field">
            <label>Search</label>
            <input id="q" placeholder="Try: Camry, Civic, Ford..." />
          </div>
          <div class="field">
            <label>Price</label>
            <select id="price">
              <option value="all">Any</option>
              <option value="0-20000">Under $20,000</option>
              <option value="20000-30000">$20,000 - $30,000</option>
              <option value="30000-999999">$30,000+</option>
            </select>
          </div>
        </div>
      </div>

      <div id="grid" class="inv-grid">
        <!-- cards injected by inventory.js if you want, but also works static -->
      </div>

      <div class="btn-row" style="margin-top:14px;">
        <a class="btn primary" href="contact.html">Ask About a Vehicle</a>
        <a class="btn" href="get-prequalified.html">Get Pre-Qualified</a>
      </div>
    </div>
  </section>
</main>

<footer class="footer">
  <div class="container">
    <div>
      <div style="font-weight:800;">Motor Town Inc</div>
      <div style="color: rgba(255,255,255,.75);">info@motortowncars.com</div>
      <div style="color: rgba(255,255,255,.75);">6880 Telephone Rd #D</div>
      <div style="color: rgba(255,255,255,.75);">Houston, TX 77061</div>
    </div>
    <div style="margin-top:10px;">
      <div style="font-weight:800;">832-353-8614</div>
      <div style="color: rgba(255,255,255,.75);">© <span id="y"></span> Motor Town Inc</div>
    </div>
  </div>
</footer>

<script src="assets/js/nav.js"></script>

<!-- Optional: inventory grid script (works even if file exists already) -->
<script>
  const grid = document.getElementById("grid");
  const q = document.getElementById("q");
  const price = document.getElementById("price");

  let cars = [];

  function inPriceRange(p, range) {
    if (range === "all") return true;
    const [a, b] = range.split("-").map(Number);
    return p >= a && p <= b;
  }

  function formatMiles(m) {
    const n = Number(m || 0);
    return n.toLocaleString();
  }

  function safeText(v) {
    return String(v ?? "").trim();
  }

  function detailRow(label, value) {
    const v = safeText(value);
    if (!v) return "";
    return `<div class="inv-line"><span class="inv-k">${label}:</span> <span class="inv-v">${v}</span></div>`;
  }

  function renderDetails(c) {
    // Preferred: a flexible details object (any keys allowed)
    if (c.details && typeof c.details === "object") {
      const entries = Object.entries(c.details);
      if (entries.length === 0) return "";

      return `
        <div class="inv-details" style="margin-top:10px;">
          ${entries.map(([k, v]) => detailRow(k, v)).join("")}
        </div>
      `;
    }

    // Fallback: if someone adds random top-level fields, we can still show some
    // (Optional safety, can remove if you want stricter)
    const allowList = ["year", "make", "model", "trim", "color", "vin", "stock", "drivetrain", "fuel", "engine", "mpg"];
    const rows = allowList
      .filter(k => c[k] !== undefined && c[k] !== null && String(c[k]).trim() !== "")
      .map(k => detailRow(k.charAt(0).toUpperCase() + k.slice(1), c[k]));

    if (rows.length === 0) return "";
    return `<div class="inv-details" style="margin-top:10px;">${rows.join("")}</div>`;
  }

  function carCard(c) {
    return `
      <div class="inv-card">
        <img class="inv-img" src="${c.image}" alt="${safeText(c.title)}"
             onerror="this.src='images/cars/placeholder.jpg'">
        <div class="inv-body">
          <h3 class="inv-title">${safeText(c.title)}</h3>
          <div class="inv-meta">${formatMiles(c.miles)} miles • ${safeText(c.transmission) || "Automatic"}</div>

          <div class="inv-price">
            <div style="font-weight:800; font-size:18px;">$${Number(c.price || 0).toLocaleString()}</div>
            ${c.tag ? `<div class="badge">${safeText(c.tag)}</div>` : ""}
          </div>

          ${renderDetails(c)}

          <div class="btn-row" style="margin-top:10px;">
            <a class="btn primary" href="contact.html">Check Availability</a>
            <a class="btn" href="get-prequalified.html">Get Pre-Qualified</a>
          </div>
        </div>
      </div>
    `;
  }

  function render() {
    const term = (q.value || "").toLowerCase();
    const range = price.value;

    const visibleCars = cars.filter(c => (c.status || "available").toLowerCase() === "available");

    const filtered = visibleCars.filter(c => {
      const title = (c.title || "").toLowerCase();
      const p = Number(c.price || 0);
      return title.includes(term) && inPriceRange(p, range);
    });

    if (filtered.length === 0) {
      grid.innerHTML = `<div class="card"><h3>No matches found</h3><p>Try adjusting your search or filters.</p></div>`;
      return;
    }

    grid.innerHTML = filtered.map(carCard).join("");
  }

  async function loadCars() {
    const res = await fetch("assets/data/cars.json", { cache: "no-store" });
    if (!res.ok) throw new Error("cars.json failed");
    cars = await res.json();

    q.addEventListener("input", render);
    price.addEventListener("change", render);

    render();
  }

  loadCars().catch(() => {
    grid.innerHTML = `<div class="card"><h3>Inventory unavailable</h3><p>Please try again later.</p></div>`;
  });

  document.getElementById("y").textContent = new Date().getFullYear();
</script>


</body>
</html>
